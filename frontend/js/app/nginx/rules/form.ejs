<div class="modal-content">
  <div class="modal-header">
    <h5 class="modal-title"><%- id? (is_system  ? i18n('str', 'view' )  : i18n('str', 'edit'))  : i18n('str', 'add') %> <%- i18n('rules-lists', 'title') %></h5>
    <button type="button" class="close cancel" aria-label="Close" data-dismiss="modal">&nbsp;</button>
  </div>
  <div class="modal-body has-tabs">
    <div class="alert alert-danger mb-0 rounded-0" id="le-error-info" role="alert"></div>
    <form>
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="nav-item"><a href="#details" aria-controls="tab1" role="tab" data-toggle="tab" class="nav-link active show" aria-selected="true"><i class="fe fe-zap"></i> <%- i18n('rules-lists', 'details') %></a></li>
        <li role="presentation" class="nav-item"><a href="#advanced" aria-controls="tab2" role="tab" data-toggle="tab" class="nav-link" aria-selected="false"><i class="fe fe-users"></i> <%- i18n('rules-lists', 'lua-script') %></a></li>
        <li role="presentation" class="nav-item"><a href="#map" aria-controls="tab3" role="tab" data-toggle="tab" class="nav-link" aria-selected="false"><i class="fe fe-users"></i> 测试</a></li>
      </ul>

      <div class="tab-content">
        <!-- Details -->
        <div role="tabpanel" class="tab-pane active show" id="details">
          <div class="row">
            <div class="col-sm-12 col-md-12">
              <div class="form-group">
                <label class="form-label"><%- i18n('rules-lists', 'name') %> <span class="form-required">*</span></label>
                <input type="text" name="name" class="form-control" <%- is_system?"disabled":"" %> value="<%- name %>" required>
              </div>
            </div>
            <div class="col-sm-12 col-md-12">
              <div class="form-group mb-0">
                <label class="form-label"><%- i18n('rules-lists', 'description') %><span class="form-required">*</span></label>
                <textarea name="description" <%- is_system?"disabled":"" %> rows="2" class="form-control text-monospace" placeholder="# <%- i18n('rules-lists', 'description-placehoder') %>" required><%- description %></textarea>
              </div>
            </div>


            <div class="col-sm-6 col-md-6">
              <div class="form-group">
                <label class="form-label"><%- i18n('rules-lists', 'exec-sort') %><span class="form-required">*</span></label>
                <input name="sort" type="number" class="form-control text-monospace" placeholder="0~100,<%- i18n('rules-lists', 'exec-sort-desc') %>" <%- is_system?"disabled":"" %> value="<%- sort %>" required>
              </div>
            </div>
            <div class="col-sm-6 col-md-6">
              <div class="form-group">
                <label class="form-label"><%- i18n('rules-lists', 'block-type') %><span class="form-required">*</span></label>
                <select name="block_type" class="form-control custom-select" placeholder="others" <%- is_system?"disabled":"" %> required>
                  <option value="others" <%- block_type === "others" ? 'selected' : '' %>><%- i18n('block-type', 'others') %></option>
                  <option value="sql-injection" <%- block_type === "sql-injection" ? 'selected' : '' %>><%- i18n('block-type', 'sql-injection') %></option>
                  <option value="xss" <%- block_type === "xss" ? 'selected' : '' %>><%- i18n('block-type', 'xss') %></option>
                  <option value="path-traversal" <%- block_type === "path-traversal" ? 'selected' : '' %>><%- i18n('block-type', 'path-traversal') %></option>
                  <option value="sensitive-path" <%- block_type === "sensitive-path" ? 'selected' : '' %>><%- i18n('block-type', 'sensitive-path') %></option>
                  <option value="cc-attack" <%- block_type === "cc-attack" ? 'selected' : '' %>><%- i18n('block-type', 'cc-attack') %></option>
                  <option value="malicious-file-upload" <%- block_type === "malicious-file-upload" ? 'selected' : '' %>><%- i18n('block-type', 'malicious-file-upload') %></option>
                </select>
              </div>
            </div>

          </div>
        </div>

        <!-- Advanced -->
        <div role="tabpanel" class="tab-pane" id="advanced">
          <div class="row">
            <div class="col-md-12">
              <div class="form-group mb-0">
                <label class="form-label"><%- i18n('rules-lists', 'lua-script-desc') %><span class="form-required">*</span></label>
                <textarea name="lua_script" rows="8" class="form-control text-monospace" placeholder="ngx.say('hello world')" required <%- is_system?"disabled":"" %>><%- lua_script %></textarea>
              </div>
              <p class="small text-gray"><i class="fe fe-alert-triangle"></i> <%- i18n('rules-lists', 'script-warning') %></p>
            </div>
          </div>
        </div>

        <!-- test -->
        <div role="tabpanel" class="tab-pane" id="map">

          <div class="card">
            <div class="card-body">
              <div id="chart-demo-line" class="chart-lg"></div>
            </div>
          </div>

          <script src="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta17/dist/libs/apexcharts/dist/apexcharts.min.js" defer></script>
          <script>
            document.addEventListener("DOMContentLoaded", function() {
              window.ApexCharts && (new ApexCharts(document.getElementById('chart-demo-line'), {
                chart: {
                  type: "line",
                  fontFamily: 'inherit',
                  height: 240,
                  parentHeightOffset: 0,
                  toolbar: {
                    show: false,
                  },
                  animations: {
                    enabled: false
                  },
                },
                fill: {
                  opacity: 1,
                },
                stroke: {
                  width: 2,
                  lineCap: "round",
                  curve: "straight",
                },
                series: [{
                  name: "Session Duration",
                  data: [117, 92, 94, 98, 75, 110, 69, 80, 109, 113, 115, 95]
                }, {
                  name: "Page Views",
                  data: [59, 80, 61, 66, 70, 84, 87, 64, 94, 56, 55, 67]
                }, {
                  name: "Total Visits",
                  data: [53, 51, 52, 41, 46, 60, 45, 43, 30, 50, 58, 59]
                }],
                tooltip: {
                  theme: 'dark'
                },
                grid: {
                  padding: {
                    top: -20,
                    right: 0,
                    left: -4,
                    bottom: -4
                  },
                  strokeDashArray: 4,
                },
                xaxis: {
                  labels: {
                    padding: 0,
                  },
                  tooltip: {
                    enabled: false
                  },
                  type: 'datetime',
                },
                yaxis: {
                  labels: {
                    padding: 4
                  },
                },
                labels: [
                  '2020-06-21', '2020-06-22', '2020-06-23', '2020-06-24', '2020-06-25', '2020-06-26', '2020-06-27', '2020-06-28', '2020-06-29', '2020-06-30', '2020-07-01', '2020-07-02'
                ],
                colors: [tabler.getColor("yellow"), tabler.getColor("green"), tabler.getColor("primary")],
                legend: {
                  show: true,
                  position: 'bottom',
                  offsetY: 12,
                  markers: {
                    width: 10,
                    height: 10,
                    radius: 100,
                  },
                  itemMargin: {
                    horizontal: 8,
                    vertical: 8
                  },
                },
              })).render();
            });
          </script>

        </div>
      </div>
    </form>
  </div>
  <% if (!is_system) { %>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary cancel" data-dismiss="modal"><%- i18n('str', 'cancel') %></button>
    <button type="button" class="btn btn-teal save"><%- i18n('str', 'save') %></button>
  </div>
  <% } %>
</div>